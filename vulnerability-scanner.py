#!/usr/bin/env python
import vuln_scan
import optparse
from termcolor import colored

def get_arguments():
	parser = optparse.OptionParser()
	parser.add_option("-u", "--url", dest="url", help="Target URL")
	parser.add_option("-i", "--ignore", dest="ignore", help="URL to ignore")
	parser.add_option("-p", "--post", dest="post", help="post form")
	
	(options, arguments) = parser.parse_args()
	
	if not options.url:
		parser.error("a url is required") 

	return options

options = get_arguments()
target_url = options.url
link_to_ignore = [options.ignore]
data_dict ={"username": "admin", "password": "password", "Login": "Login"}

vuln_scanner = vulnscanner.Scanner(target_url, link_to_ignore)
vuln_scanner.session.post(options.post, data=data_dict)
vuln_scanner.crawler()
vuln_scanner.run_scanner()